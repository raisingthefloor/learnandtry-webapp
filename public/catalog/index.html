<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Learn and Try</title>

        <link rel="stylesheet" href="/css/catalog/index.css">

        <!-- NOTE: a deferred script will be executed after the HTML is downloaded but before the DOMContentLoaded event is fired. -->
        <script defer src="/scripts/catalog/index.js" type="text/javascript"></script>
        <script>
            /* populate the initial contents (filters, tools, etc.) once the HTML DOM has loaded */
            document.addEventListener('DOMContentLoaded', async () => { 
                setupElementEvents();
                await populateInitialContents();
             });
        </script>
    </head>
    <body>
        <div id="FilterIconDiv">
            <button id="FilterButton" aria-expanded="false">
                <svg class="filter" viewBox="0 0 100 90" width="24">
                    <rect class="filter-line-1-segment-1" x="10" y="15" width="15" height="10" rx="5"></rect>
                    <circle class="filter-line-1-circle" cx="30" cy="20" r="10"></circle>
                    <rect class="filter-line-1-segment-2" x="35" y="15" width="55" height="10" rx="5"></rect>
                    <rect class="filter-line-2-segment-1" x="10" y="45" width="55" height="10" rx="5"></rect>
                    <circle class="filter-line-2-circle" cx="70" cy="50" r="10"></circle>
                    <rect class="filter-line-2-segment-2" x="75" y="45" width="15" height="10" rx="5"></rect>
                    <rect class="filter-line-3-segment-1" x="10" y="75" width="15" height="10" rx="5"></rect>
                    <circle class="filter-line-3-circle" cx="30" cy="80" r="10"></circle>
                    <rect class="filter-line-3-segment-2" x="35" y="75" width="55" height="10" rx="5"></rect>
                </svg>
            </button>
        </div>
        <header id="HeaderSection">
            <form class="SearchForm">
                <div class="SearchDiv">
                    <input type="text" id="SearchTextbox" placeholder="Search tools..." disabled>
                    <button id="SearchClearButton" class="SearchClearButton" type="button" disabled></button>
                </div>
            </form>
        </header>
        <div class="MainSection">
            <aside id="SidebarSection">
                <div id="HeaderSectionVerticalSpacer"></div>
                <p id="SidebarSectionInstructions">
                    As you check the items below, the list to the right will be filtered to show only those items that match what you check.
                </p>

                <fieldset id="FunctionsFiltersFieldset" class="FilterFieldset">
                    <legend>
                        Functions
                    </legend>
                    <!-- 'functions filters' checkboxes -->
                </fieldset>
                <fieldset id="SupportedPlatformsFiltersFieldset" class="FilterFieldset">
                    <legend>
                        Devices
                        <button class="info-button" type="button" aria-label="Information about Devices filter">
                            <span class="info-icon">i</span>
                        </button>
                        <div id="devices-info" class="info-popup" style="display: none;">
                            <div class="info-popup-content">
                                <p>Putting a checkmark next to a device type  (PC, Mac etc) will cause the solutions that run on that device to be added to the list.  (If none of them are checked then the list will contain the solutions for any and all of the devices)</p>
                                <button class="info-close">&times;</button>
                            </div>
                        </div>
                    </legend>
                    <!-- 'supportedPlatforms filters' checkboxes -->
                </fieldset>
                <fieldset id="InstallTypesFiltersFieldset" class="FilterFieldset">
                    <legend>
                        Need to Install?
                    </legend>
                    <!-- 'installTypes filters' checkboxes -->
                </fieldset>
                <fieldset id="PurchaseOptionsFiltersFieldset" class="FilterFieldset">
                    <legend>
                        Purchase Options
                    </legend>
                    <!-- 'purchaseOptions filters' checkboxes -->
                </fieldset>
            </aside>
            <main class="ContentSection">
                <div id="ContentHeader">
                    <div id="ToolsListCount"><!--All Tools--></div>
                    <div id="SortFilterSelector">
                        <span id="SortOrderLabel">Sort by:&nbsp;</span>
                        <select for="SortOrderLabel" id="SortOrderDropdownList">
                            <option value="relevance" style="display: none;">Relevance</option>
                            <option value="alphabetical">A to Z</option>
                            <option value="alphabeticalReverse">Z to A</option>
                            <option value="newestFirst" selected>Most Recent First</option>
                            <option value="oldestFirst">Least Recent First</option>
                        </select>
                    </div>
                </div>
                <div id="ToolsList">
                    <div id="ToolsListLoadingMessage">Loading Learn and Try catalog...</div>
                </div>

                <!-- template for tools list' item -->
                <template id="ToolItemTemplate">
                    <div class="ToolsListElement">
                        <button class="ToolItemHeader">
                        </button>
                        <div class="ToolItemContent">
                            <!--<div class="ToolItemNameGridCell"></div>-->
                            <div class="ToolItemButtonBarGridCell"></div>
                            <div class="ToolItemPrimaryVideoGridCell"></div>
                            <div class="ToolItemSecondaryVideosGridCell"></div>
                            <div class="ToolItemDescriptionGridCell">
                                <div class="ToolItemDescriptionGridHeader">Description</div>
                                <div class="ToolItemDescriptionGridContent"></div>
                            </div>
                            <div class="ToolItemVendorProductPageUrlGridCell">
                                <a class="ToolItemVendorProductPageUrlAnchor" href="#" target="_blank">Go to Vendor Page</a>
                            </div>
                            <div class="ToolItemFunctionsGridCell">
                                <div class="ToolItemFunctionsHeader"><strong>Functions</strong></div>
                                <ul class="ToolItemFunctionsList"></ul>
                            </div>
                            <div class="ToolItemNeedToInstallGridCell">
                                <div class="ToolItemNeedToInstallHeader"><strong>Need to Install?</strong></div>
                                <ul class="ToolItemNeedToInstallList"></ul>
                            </div>
                            <div class="ToolItemSupportedPlatformsGridCell">
                                <div class="ToolItemSupportedPlatformsHeader"><strong>Devices</strong></div>
                                <ul class="ToolItemSupportedPlatformsList"></ul>
                            </div>
                            <div class="ToolItemPurchaseOptionsGridCell">
                                <div class="ToolItemPurchaseOptionsHeader"><strong>Purchase Options</strong></div>
                                <ul class="ToolItemPurchaseOptionsList"></ul>
                            </div>
                            <div class="ToolItemInstallButtonsGridCell"></div>    
                        </div>
                    </div>
                </template>

                <!-- template for chatbot loader -->
                <template id="ChatLoaderTemplate">
                    <div class="BotMessage" id="ChatLoaderContainer">
                        <div class="BotMessageContent">
                            <div class="ChatLoader"></div>
                            <p class="ChatLoaderText">Please wait...</p>
                        </div>
                    </div>
                </template>
            </main>  
            <div id="ChatBotSection" hidden>
                <div id="ChatBotHeader">
                    <h2>Chatbot</h2>
                    <span id="ChatBotShortcut">Press Shift+Enter to close</span>
                    <button id="ChatBotCloseButton">&times;</button>
                </div>
                <div id="ChatBotContent">
                    
                </div>
                <!-- Chat Options Screen (shown initially) -->
                <div id="ChatOptionsScreen" style="display: none;">
                    <div class="chat-options-container">
                        <div id="ChatOptionsLoading">
                            <p>Checking local chatbot status... Please wait.</p>
                            <div class="ChatLoader"></div>
                        </div>
                        <div id="ChatOptionsContent" style="display: none;">
                            <h3>Chat Options</h3>
                            <p>How would you like to proceed?</p>
                            <div class="chat-option-buttons">
                                <button id="StartNewChatButton" class="chat-option-btn">
                                    <span class="option-icon">💬</span>
                                    <span class="option-text">Start a New Chat</span>
                                    <span class="option-shortcut">Press Shift + N</span>
                                </button>
                                <button id="LoadChatButton" class="chat-option-btn">
                                    <span class="option-icon">📁</span>
                                    <span class="option-text">Load a Previously Saved Chat</span>
                                    <span class="option-shortcut">Press Shift + L</span>
                                </button>
                                <button id="SetupChatbotButton" class="chat-option-btn setup-btn">
                                    <span class="option-icon">⚙️</span>
                                    <span class="option-text">Setup Local Chatbot</span>
                                    <span class="option-shortcut">Press Shift + S</span>
                                </button>
                            </div>
                            <input type="file" id="ChatFileInput" accept=".json" style="display: none;">
                        </div>
                    </div>
                </div>
                <!-- Platform Selection Screen (for chatbot setup) -->
                <div id="PlatformSelectionScreen" style="display: none;">
                    <div class="platform-selection-container">
                        <h3>Setup Local Chatbot</h3>
                        <p>Select your operating system to download the setup package:</p>
                        <div class="platform-buttons">
                            <button id="WindowsSetupButton" class="platform-btn">
                                <span class="platform-icon">🖥️</span>
                                <span class="platform-text">Windows</span>
                                <span class="platform-status">Download</span>
                            </button>
                            <button id="MacSetupButton" class="platform-btn">
                                <span class="platform-icon">🍎</span>
                                <span class="platform-text">macOS</span>
                                <span class="platform-status">Download</span>
                            </button>
                            <button id="LinuxSetupButton" class="platform-btn">
                                <span class="platform-icon">🐧</span>
                                <span class="platform-text">Linux</span>
                                <span class="platform-status">Download</span>
                            </button>
                        </div>
                        <div class="platform-info">
                            <p><strong>What's included:</strong></p>
                            <ul>
                                <li>Ollama installation</li>
                                <li>Gemma2:9b model download</li>
                                <li>Nomic-embed-text model download</li>
                                <li>One-click setup script</li>
                            </ul>
                        </div>
                        <div class="platform-actions">
                            <button id="BackToChatOptionsButton" class="back-btn">← Back</button>
                        </div>
                        <div id="DownloadLoading" class="download-loading">
                            <div class="loading-spinner"></div>
                            Download will start soon, please wait...
                        </div>
                    </div>
                </div>
                <!-- Chat Download Prompt (shown after filters applied) -->
                <div id="ChatDownloadPrompt" style="display: none;">
                    <div class="chat-download-container">
                        <h4>Save Your Chat</h4>
                        <p>Do you want to download this chat? You can load it later as and when needed.</p>
                        <div class="chat-download-buttons">
                            <button id="DownloadChatYesButton" class="download-btn download-yes">Yes, Download</button>
                            <button id="DownloadChatNoButton" class="download-btn download-no">No, Thanks</button>
                        </div>
                    </div>
                </div>
                <div id="ChatBotInput">
                    <input type="text" id="ChatBotInputTextbox" placeholder="Ask me about accessibility tools...">
                    <button id="ChatBotSendButton">Send</button>
                </div>
            </div>      
        </div>

        <div id="FloatingChatBotContainer">
            <div id="FloatingChatBotShortcutText">Press Shift+Enter</div>
            <button id="FloatingChatBotButton">
                <svg viewBox="0 0 24 24" width="24" height="24">
                    <path fill="currentColor" d="M20,2H4A2,2 0 0,0 2,4V22L6,18H20A2,2 0 0,0 22,16V4C22,2.89 21.1,2 20,2Z"/>
                </svg>
            </button>
        </div>
    </body>
</html>